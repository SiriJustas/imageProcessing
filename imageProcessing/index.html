<html>
	<head>
		<script src="scripts/reader.js" type="text/javascript"></script>
		<script src="scripts/gaussianBlur.js" type="text/javascript"></script>
		<script src="scripts/draw.js" type="text/javascript"></script>
		<script src="scripts/fast.js" type="text/javascript"></script>
		<script src="scripts/horizontalHAAR.js" type="text/javascript"></script>
		<script src="scripts/output.js" type="text/javascript"></script>
		<script src="scripts/rgbToGray.js" type="text/javascript"></script>
		<script src="scripts/searchRect.js" type="text/javascript"></script>
		<script src="scripts/check.js" type="text/javascript"></script>

		<style>
		img{
			width:auto;
			height:auto;
		}
		canvas{
			width:auto;
			height:auto;
			position:relative;

		}
		</style>
	</head>
<body>
	<image></image>
	<canvas id = "canvasas">Your browser does not support the HTML5 canvas tag.</canvas>
	<canvas id = "canvasas2">Your browser does not support the HTML5 canvas tag.</canvas>
	<script>
	var pav = document.getElementsByTagName('img')[0];
	pav.crossOrigin = "Anonymous";
	pav.setAttribute('src','https://i.imgur.com/yBRNAO8.jpg');
	
	pav.addEventListener("load", function() {
	var pix = read();
	var grayScale = rgbToGrayScale(pix);
	var blurredPix = gaussianBlur(pix);
	var blurredGrayScale = gaussianBlurForGrayScale(grayScale);



	var pav = document.getElementsByTagName("img")[0];
	var canvass2 = document.getElementById("canvasas2");
	var ctx2 = canvass2.getContext("2d");
	canvass2.width = pav.naturalWidth;
	canvass2.height = pav.naturalHeight;
	var imagedata = ctx2.createImageData(pav.naturalWidth, pav.naturalHeight);

	var binaryPix = [];

	var index = 0;
	for(var i =0; i<pix.length; i++){
		var tempBin = [];
		for(var j = 0; j<pix[i].length; j++){
			if(fast(grayScale,j,i)){
				tempBin[j] = 0;
				imagedata.data[index+0] = 0;
				imagedata.data[index+1] = 0;
				imagedata.data[index+2] = 0;
			    imagedata.data[index+3] = 255;
			}
			else{
			tempBin[j] = 255;
			imagedata.data[index+0] = 255;
			imagedata.data[index+1] = 255;
			imagedata.data[index+2] = 255;
			imagedata.data[index+3] = 255;
			}
			index+=4;
		}
		binaryPix[i] = tempBin;
	}

	
	output(imagedata,ctx2);
	var haarAttribute = horizontalHAAR(blurredPix,8,6);
	//console.log(haarAttribute);
	var res = check(blurredPix,binaryPix,pix,ctx2, haarAttribute);
	console.log(res);
	if(res.length>0){
		for(var j=0; j<res.length; j++){
			console.log("pies");
			//ctx2.save();
			drawPlus(ctx2,res[j].xx,res[j].yy);
			//ctx2.restore();
		}
	}


	//console.log(pix);
	});
	</script>
</body>
</html>
